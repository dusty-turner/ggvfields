<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A ggplot2 extension for visualizing vector fields in a two-dimensional space. 
             Provides functions to create vector field layers using user-defined vector field functions
             and the `grid` package for rendering vector fields as graphical objects.">
<title>Vector Field Visualizations with ggplot2 • ggvfields</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Vector Field Visualizations with ggplot2">
<meta property="og:description" content="A ggplot2 extension for visualizing vector fields in a two-dimensional space. 
             Provides functions to create vector field layers using user-defined vector field functions
             and the `grid` package for rendering vector fields as graphical objects.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ggvfields</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="https://github.com/dusty-turner/ggvfields/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ggvfields-">ggvfields <img src="reference/figures/ggvfields_hex.png" align="right" width="120" style="padding-left:10px;background-color:white;"><a class="anchor" aria-label="anchor" href="#ggvfields-"></a>
</h1></div>
<p><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></p>
<p><strong>ggvfields</strong> provides tools for visualizing vector fields, stream plots, and smoothed vector fields.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dusty-turner/ggvfields">"ggvfields"</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>ggplot2.continuous.colour<span class="op">=</span><span class="st">"viridis"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="op">(</span><span class="va">wind_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"lon"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, </span>
<span>  <span class="st">"lat"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, </span>
<span>  <span class="st">"dir"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span>,</span>
<span>  <span class="st">"spd"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">rchisq</a></span><span class="op">(</span><span class="va">n</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">dx</span> <span class="op">&lt;-</span> <span class="va">spd</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span>
<span>    <span class="va">dy</span> <span class="op">&lt;-</span> <span class="va">spd</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           lon         lat         dir        spd          dy          dx</span></span>
<span><span class="co">#&gt; 1  -1.2070657 -0.47719270  0.33510483  3.5473948  1.16662525  3.35007394</span></span>
<span><span class="co">#&gt; 2   0.2774292 -0.99838644  0.91989662  2.1892467  1.74163111  1.32646984</span></span>
<span><span class="co">#&gt; 3   1.0844412 -0.77625389 -1.18234275  2.9860220 -2.76355109  1.13097871</span></span>
<span><span class="co">#&gt; 4  -2.3456977  0.06445882  0.76541260 10.8072250  7.48761916  7.79305272</span></span>
<span><span class="co">#&gt; 5   0.4291247  0.95949406 -1.06958553  3.4477308 -3.02366484  1.65659245</span></span>
<span><span class="co">#&gt; 6   0.5060559 -0.11028549  0.01255049  3.9071427  0.04903528  3.90683495</span></span>
<span><span class="co">#&gt; 7  -0.5747400 -0.51100951  1.11271773  0.1561561  0.14005697  0.06905621</span></span>
<span><span class="co">#&gt; 8  -0.5466319 -0.91119542 -0.09430283  0.4239639 -0.03992176  0.42208012</span></span>
<span><span class="co">#&gt; 9  -0.5644520 -0.83717168 -1.60894263  0.4160735 -0.41577077 -0.01586782</span></span>
<span><span class="co">#&gt; 10 -0.8900378  2.41583518  1.66793304  4.1721572  4.15248944 -0.40463261</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">wind_data</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lon   lat   dir   spd    dy    dx</span></span>
<span><span class="co">#&gt; 1  -1.21 -0.48  0.34  3.55  1.17  3.35</span></span>
<span><span class="co">#&gt; 2   0.28 -1.00  0.92  2.19  1.74  1.33</span></span>
<span><span class="co">#&gt; 3   1.08 -0.78 -1.18  2.99 -2.76  1.13</span></span>
<span><span class="co">#&gt; 4  -2.35  0.06  0.77 10.81  7.49  7.79</span></span>
<span><span class="co">#&gt; 5   0.43  0.96 -1.07  3.45 -3.02  1.66</span></span>
<span><span class="co">#&gt; 6   0.51 -0.11  0.01  3.91  0.05  3.91</span></span>
<span><span class="co">#&gt; 7  -0.57 -0.51  1.11  0.16  0.14  0.07</span></span>
<span><span class="co">#&gt; 8  -0.55 -0.91 -0.09  0.42 -0.04  0.42</span></span>
<span><span class="co">#&gt; 9  -0.56 -0.84 -1.61  0.42 -0.42 -0.02</span></span>
<span><span class="co">#&gt; 10 -0.89  2.42  1.67  4.17  4.15 -0.40</span></span></code></pre></div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="geom_vector-visualizing-individual-vectors">
<code>geom_vector()</code>: Visualizing Individual Vectors<a class="anchor" aria-label="anchor" href="#geom_vector-visualizing-individual-vectors"></a>
</h3>
<p><code><a href="reference/geom_vector.html">geom_vector()</a></code> is designed to visualize individual vectors, which are essentially just line segments with (typically) arrow heads to signify their direction. As line segments, they are naturally represented as 2 points-2 <span class="math inline">(<em>x</em>,<em>y</em>)</span> pairs-signifying the start point and the end point, where the end point signifies the direction of the vector. This already possible using <code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment()</a></code>; however, <strong>ggvfields</strong>’s <code><a href="reference/geom_vector.html">geom_vector()</a></code> provides a bit more support.</p>
<p>ggvfields can plot vectors specified by either Cartesian (<code>dx</code>, <code>dy</code>) or polar (<code>angle</code>, <code>distance</code>) components. It’s especially useful for directional data like wind patterns or flow fields.</p>
<p>By default, the <strong><code>length</code> aesthetic</strong> is mapped to <code>after_stat(norm)</code>, meaning the vector length reflects its magnitude. More details in this section: <a href="#new-feature-mapping-norm-to-the-length-aesthetic"><strong>New Feature: Mapping Norm to the Length Aesthetic</strong></a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, dx <span class="op">=</span> <span class="va">dx</span>, dy <span class="op">=</span> <span class="va">dy</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>If you’d prefer to use dots on the tails instead of arrow heads, those are available, too:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, dx <span class="op">=</span> <span class="va">dx</span>, dy <span class="op">=</span> <span class="va">dy</span><span class="op">)</span>, </span>
<span>    tail_point <span class="op">=</span> <span class="cn">TRUE</span>, arrow <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>For polar coordinates, the vector is defined by an <code>angle</code> and <code>distance</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, angle <span class="op">=</span> <span class="va">dir</span>, distance <span class="op">=</span> <span class="va">spd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="new-feature-mapping-norm-to-the-length-aesthetic">New Feature: Mapping Norm to the Length Aesthetic<a class="anchor" aria-label="anchor" href="#new-feature-mapping-norm-to-the-length-aesthetic"></a>
</h3>
<p>One of the innovations of <strong>ggvfields</strong> is the ability to map the <strong>norm</strong> of vectors directly to their <strong>length</strong> using a length aesthetic. This feature allows for a more intuitive representation of vector magnitudes. The length of each vector directly corresponds to its computed norm - making it easy to compare vector magnitudes visually within the plot.</p>
<p>Traditionally, vector fields represent direction and magnitude through arrows of uniform length. This leaves magnitude to be inferred from color gradients or external legends. With <strong>ggvfields</strong>, the <strong>length</strong> aesthetic allows users to visually intuit vector magnitude simplifying their interpretation.</p>
<p>A particularly important aspect of this feature is that the vector lengths in the plot are <strong>accurately reflected in the legend</strong>. This allows viewers to match the visual representation of length directly with the legend’s magnitude scale. This frees up the color aesthetic for use in visualizing other information about the vector field.</p>
<div class="section level4">
<h4 id="why-use-the-length-aesthetic">Why Use the Length Aesthetic?<a class="anchor" aria-label="anchor" href="#why-use-the-length-aesthetic"></a>
</h4>
<ul>
<li>
<strong>Clearer Representation</strong>: Vectors with larger norms appear longer, making magnitude comparison straightforward.</li>
<li>
<strong>Length-Consistent Legends</strong>: The lengths of vectors in the plot are directly tied to the values shown in the legend, ensuring a consistent and accurate visual guide.</li>
<li>
<strong>Enhanced Visuals</strong>: Length variations add an extra layer of information to the plot, complementing existing aesthetics like color.</li>
<li>
<strong>Flexible Customization</strong>: Combine length mapping with other aesthetics such as color gradients or transparency for even richer visualizations.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="example-mapping-norm-to-length">Example: Mapping Norm to Length<a class="anchor" aria-label="anchor" href="#example-mapping-norm-to-length"></a>
</h3>
<p>By mapping the norm of a vector to the length aesthetic, users can directly observe differences in vector magnitude based on the vector’s actual size. You can do this by <code>length = after_stat(norm)</code> or <code><a href="reference/geom_vector2.html">geom_vector2()</a></code> can do this by default.</p>
<p>In this example, the norm of the wind vectors is mapped to their length:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, dx <span class="op">=</span> <span class="va">dx</span>, dy <span class="op">=</span> <span class="va">dy</span>, length <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">norm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    arrow <span class="op">=</span> <span class="cn">NULL</span>, tail_point <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="geom_vector_field-visualizing-vector-fields">
<code>geom_vector_field()</code>: Visualizing Vector Fields<a class="anchor" aria-label="anchor" href="#geom_vector_field-visualizing-vector-fields"></a>
</h3>
<p>The <code><a href="reference/geom_vector_field.html">geom_vector_field()</a></code> function creates a vector field plot using a user-defined function to compute vector components. This abstraction simplifies the mathematical computations involved in vector field visualizations. Users no longer need to manually calculate vector components for <code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment()</a></code>.</p>
<p>Two important options in <code><a href="reference/geom_vector_field.html">geom_vector_field()</a></code> are <strong>normalize</strong> and <strong>center</strong> - both of which default to <code>TRUE</code>. These options help control the visual representation of vectors:</p>
<ul>
<li><p><strong>normalize</strong>: When set to <code>TRUE</code>, this option scales each vector to have a unit length, which can help avoid overplotting in dense vector fields. This is especially useful when the direction of vectors is more important than their magnitude. However, it’s important to note that <strong>normalize</strong> is different from mapping the <strong>norm</strong> of the vector to the <strong>length</strong> aesthetic. While normalization ensures that all vectors are visually uniform in length, mapping the norm to length preserves the relative differences in magnitude by varying the vector lengths based on their actual norms.</p></li>
<li><p><strong>center</strong>: By default, <strong>center</strong> is also set to <code>TRUE</code>, meaning the midpoint of each vector is placed at the corresponding <code>(x, y)</code> coordinate, effectively “centering” the vector on the point. When <code>center</code> is <code>FALSE</code>, the base of the vector is anchored at the <code>(x, y)</code> point, and the vector extends outward from there. This is useful when the vector field is meant to represent flow starting <em>from</em> a point, rather than centered around it.</p></li>
</ul>
<p>Additionally, <strong><code><a href="reference/geom_vector_field.html">geom_vector_field()</a></code> defaults to <code>length = after_stat(norm)</code></strong>, which maps the computed vector norms to the <code>length</code> aesthetic. This means that unless specified otherwise, the vectors’ lengths will automatically be proportional to their calculated magnitudes.</p>
<p>By using these options, you can control whether vector lengths are uniform or reflect their actual magnitudes, how the vectors are positioned relative to their base coordinates, and how the <code>length</code> aesthetic is used in your plot.</p>
<div class="section level4">
<h4 id="example-basic-vector-field-plot">Example: Basic Vector Field Plot<a class="anchor" aria-label="anchor" href="#example-basic-vector-field-plot"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span> <span class="co"># = f(x,y)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_field.html">geom_vector_field</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>This function allows the user to map several characteristics of the vector field to different aesthetic mappings.</p>
</div>
</div>
<div class="section level3">
<h3 id="norm">Norm<a class="anchor" aria-label="anchor" href="#norm"></a>
</h3>
<p>The norm of a vector <span class="math inline"><strong>w</strong> = (<em>u</em>,<em>v</em>)</span> is given by:</p>
<p><span class="math inline">$|\mathbf{w}| = \sqrt{u^2 + v^2}$</span></p>
<p>We can visualize the norm by mapping it to the length aesthetic:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_field.html">geom_vector_field</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">norm</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="divergence">Divergence<a class="anchor" aria-label="anchor" href="#divergence"></a>
</h3>
<p>Divergence is an operation on a vector field that describes how the field behaves at a point—whether vectors “spread out” from a point or “converge” toward it. Locally, the divergence of a vector field <span class="math inline"><strong>F</strong></span> in <span class="math inline">ℝ<sup>2</sup></span> at a particular point measures the “outflowing-ness” or rate of expansion of the vector field around that point. The divergence is a scalar value that can indicate sources (positive divergence) or sinks (negative divergence).</p>
<p>If <span class="math inline"><strong>F</strong> = ⟨<em>F</em><sub><em>x</em></sub>(<em>x</em>,<em>y</em>), <em>F</em><sub><em>y</em></sub>(<em>x</em>,<em>y</em>)⟩</span> is a vector field, its divergence is defined as:</p>
<p><span class="math display">$$
\text{div} \, \mathbf{F} = \frac{\partial F_x}{\partial x} + \frac{\partial F_y}{\partial y}
$$</span></p>
<p>To visualize the divergence of the vector field, you can map the divergence to the color aesthetic.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_field.html">geom_vector_field</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">norm</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">divergence</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="curl">Curl<a class="anchor" aria-label="anchor" href="#curl"></a>
</h3>
<p>Curl is a measure of the rotation or swirling behavior of a vector field at a given point. In two dimensions, the curl of a vector field <span class="math inline"><strong>F</strong></span> in <span class="math inline">ℝ<sup>2</sup></span> is a scalar value that quantifies how much the vectors tend to rotate or circulate around a point. Positive curl values indicate counterclockwise rotation, while negative values represent clockwise rotation.</p>
<p>If <span class="math inline"><strong>F</strong> = ⟨<em>F</em><sub><em>x</em></sub>(<em>x</em>,<em>y</em>), <em>F</em><sub><em>y</em></sub>(<em>x</em>,<em>y</em>)⟩</span> is a vector field, its curl is defined as:</p>
<p><span class="math display">$$
\text{curl} \, \mathbf{F} = \frac{\partial F_y}{\partial x} - \frac{\partial F_x}{\partial y}
$$</span></p>
<p>To visualize the curl of the vector field, you can map the curl to the color aesthetic.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_field.html">geom_vector_field</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">curl</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="geom_streamplot">
<code>geom_streamplot()</code><a class="anchor" aria-label="anchor" href="#geom_streamplot"></a>
</h3>
<p>The <code><a href="reference/geom_streamplot.html">geom_streamplot()</a></code> function generates a stream plot layer of a user-defined vector field function. The lines in the plot represent the flow of data points through the vector field.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span>, <span class="fl">1</span> <span class="op">+</span> <span class="va">x</span> <span class="op">-</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_streamplot.html">geom_streamplot</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>The <code>chop</code> parameter (defaulted to TRUE) allows you to chop the trajectories into segments. This can be useful for better visualization of the streamlines when they are long and complex.</p>
<p>It may be useful to not break up the streamlines.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_streamplot.html">geom_streamplot</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, chop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
<p>It may also be useful to break up the streamlines into more segments. The <code>scale_stream</code> parameter (defaults to 1) adjusts the segmentation of streamlines by specifying the proportion of the streamline length used to divide it into smaller segments.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_streamplot.html">geom_streamplot</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    chop <span class="op">=</span> <span class="cn">TRUE</span>, scale_stream <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="map-calculus-measures-to-aesthetics">Map Calculus Measures to Aesthetics<a class="anchor" aria-label="anchor" href="#map-calculus-measures-to-aesthetics"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_streamplot.html">geom_streamplot</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">divergence</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">divergence</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"adjusted\ndivergence"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="animate-geom_streamplot">Animate <code>geom_streamplot()</code>
<a class="anchor" aria-label="anchor" href="#animate-geom_streamplot"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create stream plot with rownum aesthetic</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="reference/geom_streamplot.html">geom_streamplot</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>rownum <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">rownum</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span> <span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Create an animation transition plot</span></span>
<span><span class="va">anim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/animation_transition.html">animation_transition</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">p</span><span class="op">)</span> <span class="op">+</span>   </span>
<span> <span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/transition_reveal.html">transition_reveal</a></span><span class="op">(</span><span class="va">rownum</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/ease_aes.html">ease_aes</a></span><span class="op">(</span><span class="st">'linear'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Animate the plot</span></span>
<span><span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span></span>
<span>  <span class="va">anim</span>, nframes <span class="op">=</span> <span class="fl">25</span>, fps <span class="op">=</span> <span class="fl">5</span>, end_pause <span class="op">=</span> <span class="fl">0</span>, renderer <span class="op">=</span> <span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/renderers.html">gifski_renderer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-animation-1.gif" width="100%"></p>
</div>
<div class="section level3">
<h3 id="geom_flow">
<code>geom_flow()</code><a class="anchor" aria-label="anchor" href="#geom_flow"></a>
</h3>
<p>The <code><a href="reference/geom_flow.html">geom_flow()</a></code> function generates a flow plot layer for a user-defined vector field function. The lines in the plot represent the flow of data points through the vector field, visualizing the trajectory of particles over time. Each flow line traces where a “marble” would move through the vector field if dropped at a specific starting point, making this an intuitive way to visualize dynamic systems.</p>
<p>By default, the color of each flow line corresponds to time (<code>t</code>), meaning the color transitions along the path represent the progression of time. As the flow line evolves, it shows how a particle would move over time if following the vector field. You can change the coloring by mapping aesthetics to other computed measures if needed, but time remains the default.</p>
<p>Flows are computed using the <code>deSolve</code> package’s ODE solver, with the <code>rk4</code> method (a fourth-order Runge-Kutta method) used for numerical integration. This solver ensures accurate and efficient computation of flow lines, abstracting away complex calculations for the user.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_flow.html">geom_flow</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">f</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%"></p>
<p>In this example, flow lines evolve according to the vector field defined by <code>f</code>. The color along each line will show how the particle moves over time (<code>t</code>) within the vector field.</p>
<div class="section level4">
<h4 id="adaptive-parameters">Adaptive Parameters<a class="anchor" aria-label="anchor" href="#adaptive-parameters"></a>
</h4>
<p>Several parameters in <code><a href="reference/geom_flow.html">geom_flow()</a></code> are adaptive, meaning they adjust automatically based on the characteristics of the vector field and the plot limits. These adaptive parameters help optimize the flow visualization without requiring manual tuning:</p>
<ul>
<li><p><strong><code>threshold_distance</code></strong>: This parameter controls the minimum distance between adjacent flow lines to prevent them from overlapping. If not specified, it is calculated automatically as half the Euclidean distance between adjacent grid points. This ensures the plot remains uncluttered, with flow lines spaced appropriately based on the grid dimensions (<code>n</code>) and the axis limits (<code>xlim</code>, <code>ylim</code>).</p></li>
<li><p><strong><code>T</code></strong>: This parameter represents the total time span for the ODE solver to trace the flow paths. If <code>T</code> is <code>NULL</code>, it is automatically computed by starting from the center of the plot and estimating how long it would take a particle to travel from the center to the farthest boundary of the vector field - assuming that the vector field is not cyclic nor does it reach a sync. This ensures that the trajectories capture the significant dynamics of the vector field without extending unnecessarily.</p></li>
<li><p><strong><code>iterations</code></strong>: This parameter defines the number of time steps for the ODE solver to use when tracing the flow lines. A higher number of iterations results in smoother and more detailed flows. If <code>iterations</code> is left as <code>NULL</code>, it is computed adaptively based on the value of <code>T</code>, ensuring that longer time spans result in more iterations for smoother paths.</p></li>
</ul>
<p>These adaptive parameters allow <code><a href="reference/geom_flow.html">geom_flow()</a></code> to create a well-balanced plot by dynamically adjusting the precision and spacing of flow lines, based on the underlying vector field and plot limits.</p>
</div>
<div class="section level4">
<h4 id="example-with-custom-parameters">Example with Custom Parameters<a class="anchor" aria-label="anchor" href="#example-with-custom-parameters"></a>
</h4>
<p>Below is an example where we customize the grid size, time span (<code>T</code>), number of iterations, and the threshold distance between flow lines:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_flow.html">geom_flow</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">f</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">21</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    iterations <span class="op">=</span> <span class="fl">1000</span>, threshold_distance <span class="op">=</span> <span class="fl">0.5</span>, T <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="co">#&gt; Warning in geom_flow(fun = f, n = c(21, 21), xlim = c(-10, 10), ylim = c(-10, :</span></span>
<span><span class="co">#&gt; Ignoring unknown parameters: `T`</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
<!-- The `mask_shape_type` parameter allows you to specify the mask shape used for streamline generation which influences how the streamlines are placed and how closely they can approach each other. The default mask shape is `"square"`, but you can also use `"diamond"`, `"inset_square"`, or `"circle"`.  During streamline generation, when a streamline enters the specified shape, no other streamlines will enter that region.  -->
<!-- - **Square Mask (default)**: Streamlines are restricted to a grid where each cell is a square. This generally results in evenly spaced streamlines. -->
<!-- - **Diamond Mask**: Streamlines are restricted to a square grid with diamonds inset within each square.  This can create a more dense pattern which can have better visualizations for some functions. - **Inset Square Mask**: Streamlines are restricted to a grid with smaller squares inset within larger squares. This can create a denser and more detailed pattern of streamlines. -->
<!-- - **Diamond Mask**: Streamlines are restricted to a square grid with diamonds inset within each square.  This can create a more dense pattern which can have better visualizations for some functions. - **Circle Mask**: Streamlines are restricted to a grid with inset circles inside the square grid. -->
<!-- ```{r} -->
<!-- ggplot() + -->
<!--   geom_streamplot(aes(group = after_stat(id)), -->
<!--                   fun = f, xlim = c(-3, 3), ylim = c(-3, 3), max_length = 10000, -->
<!--                   max_steps = 10000, ds = .05, min_dist = .25,  -->
<!--                   mask_shape_type = "diamond") + -->
<!--   coord_fixed() + -->
<!--   theme_minimal() -->
<!-- ``` -->
<!-- ### `geom_complex_function()`{.R} -->
<!-- The `geom_complex_function()`{.R} function generates a vector field plot layer using a user-defined function to compute the vector components. This function abstracts away the mathematical computations required to generate the vector field, so the user does not need to manually calculate and input the vector components into `geom_segment()`{.R}. It simplifies the process, making it easier to create vector field visualizations without dealing with the underlying math. -->
<!-- ```{r} -->
<!-- f <- function(z) (z^2 + 1) / (z^2 - 1) -->
<!-- ggplot() + -->
<!--   geom_complex_function(fun = f, relim = c(-2, 2), imlim = c(-2, 2), n = 100) + -->
<!--   labs(x = "Real", y = "Imaginary") + -->
<!--   coord_fixed() + -->
<!--   theme(legend.box = "horizontal") -->
<!-- ``` -->
<!-- We can enhance this plot with a little help from biscale. -->
<!-- Using biscale, we can apply a bivariate color scale to the plot, which allows us to represent two variables—angle (direction) and magnitude (intensity)—simultaneously. This makes it easier to visualize how these properties change across the field. -->
<!-- ```{r} -->
<!-- library(biscale) -->
<!-- library(cowplot) -->
<!-- plot <- -->
<!--   ggplot() + -->
<!--   geom_complex_function(aes(fill = after_stat(bi_class)), -->
<!--     fun = f, relim = c(-2, 2), imlim = c(-2, 2), n = 100 -->
<!--     ) + -->
<!--     bi_scale_fill(pal = "DkBlue") + -->
<!--     labs( -->
<!--       title = "", -->
<!--       x = "Real (Re)", -->
<!--       y = "Imaginary (Im)" -->
<!--     ) + -->
<!--     bi_theme(base_size = 16) + -->
<!--     theme(legend.position = "none") + -->
<!--   coord_fixed()  -->
<!-- legend <- bi_legend(pal = "DkBlue", -->
<!--                     xlab = "Angle", -->
<!--                     ylab = "Magnitude", -->
<!--                     size = 6) -->
<!-- ggdraw() + -->
<!--   draw_plot(plot, 0, 0, .8, 1) +   -->
<!--   draw_plot(legend, x = .55, y = .6, width = .3, height = 0.3) -->
<!-- ``` -->
</div>
</div>
</div>
<div class="section level2">
<h2 id="in-development">In Development<a class="anchor" aria-label="anchor" href="#in-development"></a>
</h2>
<div class="section level3">
<h3 id="geom_vector_smooth">
<code>geom_vector_smooth()</code><a class="anchor" aria-label="anchor" href="#geom_vector_smooth"></a>
</h3>
<p>The <code><a href="reference/geom_vector_smooth.html">geom_vector_smooth()</a></code> function is designed to provide a smoothed estimate of a vector field based on observed vector components. Just as <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> fits a regression line through data points, <code><a href="reference/geom_vector_smooth.html">geom_vector_smooth()</a></code> fits a smooth vector field through individual vector observations. It does this by applying statistical smoothing techniques to the vector components (<code>dx</code>, <code>dy</code>) to create a smooth representation of the direction and magnitude transitions across the field.</p>
<div class="section level4">
<h4 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h4>
<p>Let’s revisit the <code>wind_data</code> dataset we used earlier, which contains wind measurements with longitude (<code>lon</code>), latitude (<code>lat</code>), and wind vector components (<code>dx</code>, <code>dy</code>).</p>
</div>
<div class="section level4">
<h4 id="basic-smoothing-of-the-vector-field">Basic Smoothing of the Vector Field:<a class="anchor" aria-label="anchor" href="#basic-smoothing-of-the-vector-field"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, dx <span class="op">=</span> <span class="va">dx</span>, dy <span class="op">=</span> <span class="va">dy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_smooth.html">geom_vector_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="100%"></p>
<p>In this example:</p>
<ul>
<li>We use <code><a href="reference/geom_vector_smooth.html">geom_vector_smooth()</a></code> to create a smoothed estimate of the vector field based on the observed vectors.<br>
</li>
<li>The smoothed vectors are overlaid on the plot.<br>
</li>
<li>We add the original vectors using geom_vector() and set aes(color = after_stat(NULL)) to allow the vectors to be colored black.</li>
</ul>
</div>
<div class="section level4">
<h4 id="adjusting-the-grid-resolution-with-n">Adjusting the Grid Resolution with <code>n</code>:<a class="anchor" aria-label="anchor" href="#adjusting-the-grid-resolution-with-n"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, dx <span class="op">=</span> <span class="va">dx</span>, dy <span class="op">=</span> <span class="va">dy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_smooth.html">geom_vector_smooth</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-18-1.png" width="100%"></p>
<p>In this example:</p>
<ul>
<li>We specify <code>n = 4</code> to adjust the grid resolution of the smoothed vector field. This means the smoothing is evaluated over a 4x4 grid across the data range.</li>
<li>A lower <code>n</code> results in fewer vectors which can help in identifying broader trends in the vector field.</li>
<li>The original vectors are added for comparison.</li>
</ul>
</div>
<div class="section level4">
<h4 id="evalutating-at-specific-points-with-eval_points">Evalutating at Specific Points with <code>eval_points</code>:<a class="anchor" aria-label="anchor" href="#evalutating-at-specific-points-with-eval_points"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, dx <span class="op">=</span> <span class="va">dx</span>, dy <span class="op">=</span> <span class="va">dy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_smooth.html">geom_vector_smooth</a></span><span class="op">(</span>eval_points <span class="op">=</span> <span class="va">eval_point</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>, normalize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-19-1.png" width="100%"></p>
<p>In this example:</p>
<ul>
<li>We create a tibble <code>eval_point</code> containing the specific point (x = -1, y = 1) where we want to evaluate the smoothed vector field.<br>
</li>
<li>By passing <code>eval_points = eval_point</code> to geom_vector_smooth(), we compute the smoothed vector only at this location.</li>
<li>We set <code>normalize = FALSE</code> in geom_vector() to display the original vectors without normalization. This preservs their true magnitudes for comparison.</li>
</ul>
</div>
<div class="section level4">
<h4 id="additional-details">Additional Details<a class="anchor" aria-label="anchor" href="#additional-details"></a>
</h4>
<ul>
<li>Smoothing Methods: <code><a href="reference/geom_vector_smooth.html">geom_vector_smooth()</a></code> uses linear modeling (<code>method = "lm"</code>) by default to smooth the vector components. Future work will allow you to declare other techniques.<br>
</li>
<li>Confidence Intervals: By specifying <code>probs = c(0.95, 0.68)</code>, you can add prediction intervals to the smoothed vectors. This representing the uncertainty in the estimates.<br>
</li>
<li>Grid Resolution: The <code>n</code> parameter controls the number of grid points in the x and y directions over which the smoothing is evaluated. Adjusting <code>n</code> allows you to balance detail and clarity in your visualization.<br>
</li>
<li>Evaluating at Custom Points: The <code>eval_points</code> parameter accepts a data frame of points at which you want to evaluate the smoothed vector field. This is useful when you are interested in specific locations rather than a regular grid.</li>
</ul>
</div>
<div class="section level4">
<h4 id="comprehensive-example-with-prediction-intervals">Comprehensive Example with Prediction Intervals<a class="anchor" aria-label="anchor" href="#comprehensive-example-with-prediction-intervals"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wind_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, dx <span class="op">=</span> <span class="va">dx</span>, dy <span class="op">=</span> <span class="va">dy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector_smooth.html">geom_vector_smooth</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.68</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_vector.html">geom_vector</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-20-1.png" width="100%"></p>
<p>In this example:</p>
<ul>
<li>We set <code>n = c(6, 6)</code> to specify a 6x6 grid for smoothing.<br>
</li>
<li>The <code>probs</code> parameter adds 95% and 68% prediction intervals around the smoothed vectors.<br>
</li>
<li>We specify <code>method = "lm"</code> for linear smoothing.</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><strong>ggvfields</strong> is not yet on CRAN. You can install it with</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"dusty-turner/ggvfields"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is licensed under the MIT License.</p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>For any questions or issues, please <a href="https://github.com/dusty-turner/ggvfields/issues/new">open an issue</a> on GitHub or contact the maintainer.</p>
</div>
<div class="section level2">
<h2 id="related-projects">Related projects<a class="anchor" aria-label="anchor" href="#related-projects"></a>
</h2>
<p>For creating vector fields, the <a href="http://pkg.mitchelloharawild.com/ggquiver/"><strong>ggquiver</strong></a> package provides quiver plots to visualize vector fields, while the <a href="https://github.com/mdhall272/ggarchery"><strong>ggarchery</strong></a> package can handling of segments with arrowheads.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/dusty-turner/ggvfields/">Browse source code</a></li>
<li><a href="https://github.com/dusty-turner/ggvfields/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggvfields</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dusty Turner <br><small class="roles"> Author, maintainer </small>  </li>
<li>David Kahle <br><small class="roles"> Author </small>  </li>
<li>Rodney X. Sturdivant <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dusty Turner, David Kahle, Rodney X. Sturdivant.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
